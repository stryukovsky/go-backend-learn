\newpage
\begin{center}
	\textbf{\large 3. ВЛИЯНИЕ ВЫПУКЛОСТИ ТОРГОВОГО МНОЖЕСТВА НА ПОВЕДЕНИЕ ПОСТАВЩИКОВ ЛИКВИДНОСТИ}
\end{center}
\refstepcounter{chapter}
\addcontentsline{toc}{chapter}{3. ВЛИЯНИЕ ВЫПУКЛОСТИ ТОРГОВОГО МНОЖЕСТВА НА ПОВЕДЕНИЕ ПОСТАВЩИКОВ ЛИКВИДНОСТИ}

\section{Задача арбитража}

Задача арбитража неизбежно возникает при рассмотрении любой торговой платформы или биржи. В общем виде, задача формулируется как максимизация выхода от сделки, вычисленного с помощью внешнего источника цен активов. Арбитраж по определению невозможен без внешнего (относительно рассматриваемой платформы) источника данных о ценах на активы.

\begin{equation}
	\max{\mathbf{c} \cdot (\lambda - \delta)}
	\label{eq:arbitrage_problem_general}
\end{equation}

Где $(\delta; \lambda) \in T(\mathbf{R})$ -- валидная сделка из торгового множества для текущего состояния пула $\mathbf{R}$.  
Можно иначе выразить, через $\mathbf{R}$ и $\mathbf{R'}$, где $\mathbf{R'}$ -- состояние пула после одной сделки $(\delta; \lambda) \in T(R)$: 

\begin{equation}
\max{\mathbf{c} \cdot (\mathbf{R} - \mathbf{R'})}
	\label{eq:arbitrage_problem_general_via_states}
\end{equation}

Почему такое выражение возможно? $\mathbf{R'} = \mathbf{R} + \delta - \lambda$, т.к. когда сделка проходит, из пула изымается $\lambda$ токенов и добавляется $\delta$ токенов.  
Если выразить $\delta - \lambda = \mathbf{R'} - \mathbf{R}$, а затем поменять знаки, получим, что $\lambda - \delta = \mathbf{R} - \mathbf{R'}$, т.е. вместо $\lambda - \delta$ можно подставить $\mathbf{R} - \mathbf{R'}$ и наоборот. 

Функция $f(R') = \mathbf{c} \cdot (\mathbf{R} - \mathbf{R'})$ является линейной по $R'$, максимальное значение функции $f$ будет в точке минимального значения $\mathbf{c} \cdot \mathbf{R'}$.  

Теорема о выпуклой оптимизации

\section{Множество оптимальных решений выпукло}

Утверждение: Если максимизируется значение вогнутой функцию (или минимизируем выпуклую) на выпуклом множестве, то локальный оптимум является глобальным оптимумом.

Доказательство единственности и выпуклости множества решений:
Пусть $R_1^*$ и $R_2^*$ — два оптимума для которых $\mathbf{c} \cdot \mathbf{R_{1^{*}}} = \mathbf{c} \cdot \mathbf{R_{2^{*}}} = v$.  

Для любого $\theta \in [0,1]$, пусть $\mathbf{R_{\theta}} = \theta \cdot \mathbf{R_{1}^{*}} + (1 - \theta) \cdot \mathbf{R_{2}^{*}}$. Тогда 

$\mathbf{c} \cdot \mathbf{R_{\theta}}  = \mathbf{c} \cdot (\theta \cdot \mathbf{R_{1}^{*}} + (1 - \theta) \cdot \mathbf{R_{2}^{*}}) = \theta \cdot \mathbf{c} \cdot \mathbf{R_{1}^{*}} + (1 - \theta) \cdot \mathbf{c} \cdot \mathbf{R_{2}^{*}} = \theta \cdot v + (1 - \theta) \cdot v = v$

Тогда $\mathbf{R_{\theta}}$ -- тоже оптимум.  

\section{Задача арбитража в UniswapV3}
Для UniswapV3 можно сформулировать задачу арбитража следующим образом:

\begin{equation}
\max{(c_2 \cdot \lambda_2 - c_1 \cdot \delta_1)}
	\label{eq:arbitrage_problem_uniswap_v3}
\end{equation}

Где $c_1$ -- внешняя цена актива 1 ($\mathbf{R_1}$ в <<терминах>> резервов), а $c_2$ -- цена актива 2 соответственно. Внешняя цена поставляется, например, сторонней торговой площадкой, централизованной биржей и т.д.  Например, если в пуле ликвидности находятся активы Wrapped Ethereum и Wrapped Bitcoin, то внешние цены таких активов удобно представлять в виде цены в долларах США или рублях за единицу актива.  

Идея формулизации проста: арбитражник интересуется заработком на разнице в курсе активов на разных площадках. В рассматриваемой постановке арбитражник покупает актив 2, а продает актив 1, хотя для UniswapV3 это непринципиально, и можно сформулировать наоборот. Доход арбитражника максимален тогда, когда максимальна разница между тем, за сколько он купил актив 2 и за сколько он продал актив 1.


